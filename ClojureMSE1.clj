;; gorilla-repl.fileformat = 1

;; **
;;; # 線形回帰を最急降下法で解く
;;; 
;;; 
;;; 今回はclojure.core.matrixの標準のみを使っている。
;;; 
;;; clojure.core.matrixのみだと逆行列を自動的に求められないので、逆行列を使う解析解ではなく、数値解の求め方である最急降下法で解く。
;; **

;; @@
(ns indigo-leaves
  (:refer-clojure :exclude [+ - * / == < <= > >= not= = min max])
  (:require 
    [clojure.core.matrix :as m]
    [clojure.core.matrix.operators :refer :all]
    [clojure.core.matrix.random :as mr]
    [gorilla-plot.core :as plot]))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-nil'>nil</span>","value":"nil"}
;; <=

;; **
;;; まずはデータ作成。
;;; 
;;; x値を0~1の連続一様分布からとり、y値を以下の式から求める：
;;; 
;;; $$y=2+5x+0.5\epsilon$$
;;; 
;;; @@\epsilon@@はガウス分布に従う確率変数とする。
;; **

;; @@
(def n 50)
(def theta (m/matrix [[2.0 5.0]]))
(def sigma 0.50)

(def x0 (m/matrix (repeat n 1)))
(def x1 (mr/sample-uniform n 0))　;; 0は乱数のシード値

(def X
  (m/join
    (m/reshape x0 [1 n])
    (m/reshape x1 [1 n])))

(def y-without-error (m/mmul theta X))

(def errors (* (mr/sample-normal n 0) sigma))　;; 0は乱数のシード値

(def y (+ y-without-error errors))

(plot/list-plot (map vector x1 (first y)))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"data":[{"name":"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a","values":[{"x":0.730967787376657,"y":6.056105468752801},{"x":0.24053641567148587,"y":2.751909034148673},{"x":0.6374174253501083,"y":6.227547521964622},{"x":0.5504370051176339,"y":5.134070409806414},{"x":0.5975452777972018,"y":5.480013655427266},{"x":0.3332183994766498,"y":2.8243858679995775},{"x":0.3851891847407185,"y":3.9123007922496487},{"x":0.984841540199809,"y":6.981830552430056},{"x":0.8791825178724801,"y":6.200829068672432},{"x":0.9412491794821144,"y":6.384551490847347},{"x":0.27495396603548483,"y":3.4010002837768423},{"x":0.12889715087377673,"y":2.9051567928338287},{"x":0.14660165764651822,"y":2.321024786888506},{"x":0.023238122483889456,"y":2.2465497094336255},{"x":0.5467397571984656,"y":4.5072049080712},{"x":0.9644868606768501,"y":7.524007994244719},{"x":0.10449068625097169,"y":2.6580187397899597},{"x":0.6251463634655593,"y":5.122204809652878},{"x":0.4107961954910617,"y":4.5064603271609736},{"x":0.7763122912749325,"y":6.309988580425002},{"x":0.990722785714783,"y":7.13978096929517},{"x":0.4872328470301428,"y":4.635000654651905},{"x":0.7462414053223305,"y":5.762679911419385},{"x":0.7331520701949938,"y":6.136490349798697},{"x":0.8172970714093244,"y":6.307037252564166},{"x":0.8388903500470183,"y":5.828511884655097},{"x":0.5266994346048661,"y":4.627615367098191},{"x":0.8993350116114935,"y":6.41799395998379},{"x":0.13393984058689223,"y":2.378570088375148},{"x":0.0830623982249149,"y":2.312326901874604},{"x":0.9785743401478403,"y":6.692921087783514},{"x":0.7223571191888487,"y":6.057443403477006},{"x":0.7150310138504744,"y":5.7805353863822},{"x":0.14322038530059678,"y":2.1304836763546695},{"x":0.4629578184224229,"y":4.119534982657109},{"x":0.004485602182885184,"y":2.267498212856079},{"x":0.07149831487989411,"y":2.837379201301554},{"x":0.34842022979166454,"y":4.118294246565511},{"x":0.3387696535357536,"y":3.3648700598920156},{"x":0.859356551354648,"y":6.6192989233531545},{"x":0.9715469888517128,"y":6.7000087834877124},{"x":0.8657458802140383,"y":6.856176798127287},{"x":0.6125811047098682,"y":5.360797112920585},{"x":0.17898798452881726,"y":3.406215406654946},{"x":0.21757041220968598,"y":1.9097536094804708},{"x":0.8544871670422907,"y":5.509901777540129},{"x":0.009673497300974332,"y":2.638796122613874},{"x":0.6922930069529333,"y":5.464535510300139},{"x":0.7713129661706796,"y":5.788070125816393},{"x":0.7126874281456893,"y":5.352333174692435}]}],"marks":[{"type":"symbol","from":{"data":"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}}],"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :data [{:name \"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a\", :values ({:x 0.730967787376657, :y 6.056105468752801} {:x 0.24053641567148587, :y 2.751909034148673} {:x 0.6374174253501083, :y 6.227547521964622} {:x 0.5504370051176339, :y 5.134070409806414} {:x 0.5975452777972018, :y 5.480013655427266} {:x 0.3332183994766498, :y 2.8243858679995775} {:x 0.3851891847407185, :y 3.9123007922496487} {:x 0.984841540199809, :y 6.981830552430056} {:x 0.8791825178724801, :y 6.200829068672432} {:x 0.9412491794821144, :y 6.384551490847347} {:x 0.27495396603548483, :y 3.4010002837768423} {:x 0.12889715087377673, :y 2.9051567928338287} {:x 0.14660165764651822, :y 2.321024786888506} {:x 0.023238122483889456, :y 2.2465497094336255} {:x 0.5467397571984656, :y 4.5072049080712} {:x 0.9644868606768501, :y 7.524007994244719} {:x 0.10449068625097169, :y 2.6580187397899597} {:x 0.6251463634655593, :y 5.122204809652878} {:x 0.4107961954910617, :y 4.5064603271609736} {:x 0.7763122912749325, :y 6.309988580425002} {:x 0.990722785714783, :y 7.13978096929517} {:x 0.4872328470301428, :y 4.635000654651905} {:x 0.7462414053223305, :y 5.762679911419385} {:x 0.7331520701949938, :y 6.136490349798697} {:x 0.8172970714093244, :y 6.307037252564166} {:x 0.8388903500470183, :y 5.828511884655097} {:x 0.5266994346048661, :y 4.627615367098191} {:x 0.8993350116114935, :y 6.41799395998379} {:x 0.13393984058689223, :y 2.378570088375148} {:x 0.0830623982249149, :y 2.312326901874604} {:x 0.9785743401478403, :y 6.692921087783514} {:x 0.7223571191888487, :y 6.057443403477006} {:x 0.7150310138504744, :y 5.7805353863822} {:x 0.14322038530059678, :y 2.1304836763546695} {:x 0.4629578184224229, :y 4.119534982657109} {:x 0.004485602182885184, :y 2.267498212856079} {:x 0.07149831487989411, :y 2.837379201301554} {:x 0.34842022979166454, :y 4.118294246565511} {:x 0.3387696535357536, :y 3.3648700598920156} {:x 0.859356551354648, :y 6.6192989233531545} {:x 0.9715469888517128, :y 6.7000087834877124} {:x 0.8657458802140383, :y 6.856176798127287} {:x 0.6125811047098682, :y 5.360797112920585} {:x 0.17898798452881726, :y 3.406215406654946} {:x 0.21757041220968598, :y 1.9097536094804708} {:x 0.8544871670422907, :y 5.509901777540129} {:x 0.009673497300974332, :y 2.638796122613874} {:x 0.6922930069529333, :y 5.464535510300139} {:x 0.7713129661706796, :y 5.788070125816393} {:x 0.7126874281456893, :y 5.352333174692435})}], :marks [{:type \"symbol\", :from {:data \"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}}], :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"6b3ab5fb-ce3d-4363-92aa-fe486acdc61a\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}]}}"}
;; <=

;; **
;;; $$\hat{y} = \theta_0 + \theta_1 x$$
;;; とした時に、@@\hat{y}@@と@@y@@の差の二乗を最小に留める@@\theta=[\theta_0,\theta_1]@@を求めたい。
;;; 
;;; @@J@@はその差の二乗をコスト関数として表したもの。
;;; 
;;; 数値解を求めるので、とりあえず初期値として@@\theta_{initial}=[1.0, 1.0]@@としておく。
;;; 
;;; この初期値のコストは6.092なのがわかる。
;; **

;; @@
(defn J [theta X y]
  (-> (m/mmul theta X) 
      (- y) 
      (** 2) 
      m/esum 
      (/ (* 2 (m/ecount y)))))

(def initial-theta (m/matrix [[1.0 1.0]]))

(J initial-theta X y)
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-double'>6.091960100988192</span>","value":"6.091960100988192"}
;; <=

;; **
;;; 最急降下法は@@\theta@@の添字@@j@@につき
;;; 
;;; $$\theta_j := \theta_j - \alpha\frac{1}{m} \sum^m_i(h_t(x^{(i)}) - y^{(i)})x^{(i)}_j$$
;;; 
;;; （ただし@@\sum^m\_i@@は@@\sum^m\_{i=1}@@、そして@@h\_t@@は@@h\_{\theta}@@）
;;; 
;;; （@@\alpha@@は一回の更新でどれだけ大きく@@\theta@@を変化させるかをコントロールする学習レート変数）
;;; 
;;; の更新をすべての@@j@@で_同時_に行うことを繰り返して最適解に近似していく。
;;; 
;;; 
;; **

;; @@
(defn next-theta [theta X y alpha]
  (let [z (m/ecount y)
        hx (m/mmul theta X)
        hx-y (- hx y)
        hx-yx (* (m/reshape hx-y [z]) X)
        s (apply map + (m/transpose hx-yx))
        t (/ s z)
        u (* t alpha)]
    (- theta u)))
;; @@
;; =>
;;; {"type":"html","content":"<span class='clj-var'>#&#x27;indigo-leaves/next-theta</span>","value":"#'indigo-leaves/next-theta"}
;; <=

;; **
;;; @@\theta_{15000}@@：15000回繰り返した結果
;; **

;; @@
(def theta1 (first (drop 15000 (iterate #(next-theta % X y 0.01) theta1))))
theta1
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>1.985562864044468</span>","value":"1.985562864044468"},{"type":"html","content":"<span class='clj-double'>5.123606202486816</span>","value":"5.123606202486816"}],"value":"[1.985562864044468 5.123606202486816]"}],"value":"[[1.985562864044468 5.123606202486816]]"}
;; <=

;; **
;;; @@\theta_{30000}@@：30000回繰り返した結果
;; **

;; @@
(def theta2 (first (drop 30000 (iterate #(next-theta % X y 0.01) theta1))))
theta2
;; @@
;; =>
;;; {"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"list-like","open":"<span class='clj-vector'>[</span>","close":"<span class='clj-vector'>]</span>","separator":" ","items":[{"type":"html","content":"<span class='clj-double'>1.9855394838675537</span>","value":"1.9855394838675537"},{"type":"html","content":"<span class='clj-double'>5.12364619237104</span>","value":"5.12364619237104"}],"value":"[1.9855394838675537 5.12364619237104]"}],"value":"[[1.9855394838675537 5.12364619237104]]"}
;; <=

;; **
;;; @@\theta\_{15000}@@と@@\theta_{30000}@@の差がわずかであり、さらに実際の分布の母数である2.0と5.0を近似していることがわかる。
;;; 
;;; @@\theta_{30000}@@のグラフ：
;; **

;; @@
(defn theta2-line [x]
  (let [t0 (first (first theta2))
        t1 (second (first theta2))]
    (+ t0 (* t1 x))))

(plot/compose
  (plot/plot theta2-line [0 1] :color "red" :plot-points 50)
  (plot/list-plot (map vector x1 (first y))))
;; @@
;; =>
;;; {"type":"vega","content":{"width":400,"height":247.2187957763672,"padding":{"top":10,"left":55,"bottom":40,"right":10},"scales":[{"name":"x","type":"linear","range":"width","zero":false,"domain":{"data":"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55","field":"data.x"}},{"name":"y","type":"linear","range":"height","nice":true,"zero":false,"domain":{"data":"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55","field":"data.y"}}],"axes":[{"type":"x","scale":"x"},{"type":"y","scale":"y"}],"data":[{"name":"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55","values":[{"x":0,"y":1.9855394838675537},{"x":0.019999999552965164,"y":2.0880124054245264},{"x":0.03999999910593033,"y":2.1904853269814986},{"x":0.05999999865889549,"y":2.292958248538471},{"x":0.07999999821186066,"y":2.395431170095444},{"x":0.09999999776482582,"y":2.497904091652416},{"x":0.11999999731779099,"y":2.6003770132093886},{"x":0.13999999687075615,"y":2.702849934766361},{"x":0.1599999964237213,"y":2.8053228563233334},{"x":0.17999999597668648,"y":2.907795777880306},{"x":0.19999999552965164,"y":3.0102686994372787},{"x":0.2199999950826168,"y":3.112741620994251},{"x":0.23999999463558197,"y":3.215214542551223},{"x":0.25999999418854713,"y":3.3176874641081957},{"x":0.2799999937415123,"y":3.4201603856651683},{"x":0.29999999329447746,"y":3.522633307222141},{"x":0.3199999928474426,"y":3.625106228779113},{"x":0.3399999924004078,"y":3.7275791503360853},{"x":0.35999999195337296,"y":3.830052071893058},{"x":0.3799999915063381,"y":3.9325249934500306},{"x":0.3999999910593033,"y":4.034997915007003},{"x":0.41999999061226845,"y":4.137470836563976},{"x":0.4399999901652336,"y":4.239943758120948},{"x":0.4599999897181988,"y":4.34241667967792},{"x":0.47999998927116394,"y":4.444889601234893},{"x":0.4999999888241291,"y":4.5473625227918655},{"x":0.5199999883770943,"y":4.649835444348838},{"x":0.5399999879300594,"y":4.75230836590581},{"x":0.5599999874830246,"y":4.854781287462783},{"x":0.5799999870359898,"y":4.957254209019755},{"x":0.5999999865889549,"y":5.059727130576728},{"x":0.6199999861419201,"y":5.1622000521337},{"x":0.6399999856948853,"y":5.264672973690672},{"x":0.6599999852478504,"y":5.367145895247646},{"x":0.6799999848008156,"y":5.469618816804617},{"x":0.6999999843537807,"y":5.57209173836159},{"x":0.7199999839067459,"y":5.674564659918563},{"x":0.7399999834597111,"y":5.777037581475534},{"x":0.7599999830126762,"y":5.879510503032508},{"x":0.7799999825656414,"y":5.98198342458948},{"x":0.7999999821186066,"y":6.084456346146453},{"x":0.8199999816715717,"y":6.186929267703425},{"x":0.8399999812245369,"y":6.289402189260397},{"x":0.8599999807775021,"y":6.39187511081737},{"x":0.8799999803304672,"y":6.494348032374342},{"x":0.8999999798834324,"y":6.596820953931315},{"x":0.9199999794363976,"y":6.699293875488287},{"x":0.9399999789893627,"y":6.801766797045259},{"x":0.9599999785423279,"y":6.904239718602232},{"x":0.979999978095293,"y":7.006712640159204},{"x":0.9999999776482582,"y":7.109185561716178}]},{"name":"b40ab74d-9f22-4bcc-bc36-339bd4b35dd3","values":[{"x":0.730967787376657,"y":6.056105468752801},{"x":0.24053641567148587,"y":2.751909034148673},{"x":0.6374174253501083,"y":6.227547521964622},{"x":0.5504370051176339,"y":5.134070409806414},{"x":0.5975452777972018,"y":5.480013655427266},{"x":0.3332183994766498,"y":2.8243858679995775},{"x":0.3851891847407185,"y":3.9123007922496487},{"x":0.984841540199809,"y":6.981830552430056},{"x":0.8791825178724801,"y":6.200829068672432},{"x":0.9412491794821144,"y":6.384551490847347},{"x":0.27495396603548483,"y":3.4010002837768423},{"x":0.12889715087377673,"y":2.9051567928338287},{"x":0.14660165764651822,"y":2.321024786888506},{"x":0.023238122483889456,"y":2.2465497094336255},{"x":0.5467397571984656,"y":4.5072049080712},{"x":0.9644868606768501,"y":7.524007994244719},{"x":0.10449068625097169,"y":2.6580187397899597},{"x":0.6251463634655593,"y":5.122204809652878},{"x":0.4107961954910617,"y":4.5064603271609736},{"x":0.7763122912749325,"y":6.309988580425002},{"x":0.990722785714783,"y":7.13978096929517},{"x":0.4872328470301428,"y":4.635000654651905},{"x":0.7462414053223305,"y":5.762679911419385},{"x":0.7331520701949938,"y":6.136490349798697},{"x":0.8172970714093244,"y":6.307037252564166},{"x":0.8388903500470183,"y":5.828511884655097},{"x":0.5266994346048661,"y":4.627615367098191},{"x":0.8993350116114935,"y":6.41799395998379},{"x":0.13393984058689223,"y":2.378570088375148},{"x":0.0830623982249149,"y":2.312326901874604},{"x":0.9785743401478403,"y":6.692921087783514},{"x":0.7223571191888487,"y":6.057443403477006},{"x":0.7150310138504744,"y":5.7805353863822},{"x":0.14322038530059678,"y":2.1304836763546695},{"x":0.4629578184224229,"y":4.119534982657109},{"x":0.004485602182885184,"y":2.267498212856079},{"x":0.07149831487989411,"y":2.837379201301554},{"x":0.34842022979166454,"y":4.118294246565511},{"x":0.3387696535357536,"y":3.3648700598920156},{"x":0.859356551354648,"y":6.6192989233531545},{"x":0.9715469888517128,"y":6.7000087834877124},{"x":0.8657458802140383,"y":6.856176798127287},{"x":0.6125811047098682,"y":5.360797112920585},{"x":0.17898798452881726,"y":3.406215406654946},{"x":0.21757041220968598,"y":1.9097536094804708},{"x":0.8544871670422907,"y":5.509901777540129},{"x":0.009673497300974332,"y":2.638796122613874},{"x":0.6922930069529333,"y":5.464535510300139},{"x":0.7713129661706796,"y":5.788070125816393},{"x":0.7126874281456893,"y":5.352333174692435}]}],"marks":[{"type":"line","from":{"data":"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"stroke":{"value":"red"},"strokeWidth":{"value":2},"strokeOpacity":{"value":1}}}},{"type":"symbol","from":{"data":"b40ab74d-9f22-4bcc-bc36-339bd4b35dd3"},"properties":{"enter":{"x":{"scale":"x","field":"data.x"},"y":{"scale":"y","field":"data.y"},"fill":{"value":"steelblue"},"fillOpacity":{"value":1}},"update":{"shape":"circle","size":{"value":70},"stroke":{"value":"transparent"}},"hover":{"size":{"value":210},"stroke":{"value":"white"}}}}]},"value":"#gorilla_repl.vega.VegaView{:content {:width 400, :height 247.2188, :padding {:top 10, :left 55, :bottom 40, :right 10}, :scales [{:name \"x\", :type \"linear\", :range \"width\", :zero false, :domain {:data \"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55\", :field \"data.x\"}} {:name \"y\", :type \"linear\", :range \"height\", :nice true, :zero false, :domain {:data \"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55\", :field \"data.y\"}}], :axes [{:type \"x\", :scale \"x\"} {:type \"y\", :scale \"y\"}], :data ({:name \"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55\", :values ({:x 0, :y 1.9855394838675537} {:x 0.019999999552965164, :y 2.0880124054245264} {:x 0.03999999910593033, :y 2.1904853269814986} {:x 0.05999999865889549, :y 2.292958248538471} {:x 0.07999999821186066, :y 2.395431170095444} {:x 0.09999999776482582, :y 2.497904091652416} {:x 0.11999999731779099, :y 2.6003770132093886} {:x 0.13999999687075615, :y 2.702849934766361} {:x 0.1599999964237213, :y 2.8053228563233334} {:x 0.17999999597668648, :y 2.907795777880306} {:x 0.19999999552965164, :y 3.0102686994372787} {:x 0.2199999950826168, :y 3.112741620994251} {:x 0.23999999463558197, :y 3.215214542551223} {:x 0.25999999418854713, :y 3.3176874641081957} {:x 0.2799999937415123, :y 3.4201603856651683} {:x 0.29999999329447746, :y 3.522633307222141} {:x 0.3199999928474426, :y 3.625106228779113} {:x 0.3399999924004078, :y 3.7275791503360853} {:x 0.35999999195337296, :y 3.830052071893058} {:x 0.3799999915063381, :y 3.9325249934500306} {:x 0.3999999910593033, :y 4.034997915007003} {:x 0.41999999061226845, :y 4.137470836563976} {:x 0.4399999901652336, :y 4.239943758120948} {:x 0.4599999897181988, :y 4.34241667967792} {:x 0.47999998927116394, :y 4.444889601234893} {:x 0.4999999888241291, :y 4.5473625227918655} {:x 0.5199999883770943, :y 4.649835444348838} {:x 0.5399999879300594, :y 4.75230836590581} {:x 0.5599999874830246, :y 4.854781287462783} {:x 0.5799999870359898, :y 4.957254209019755} {:x 0.5999999865889549, :y 5.059727130576728} {:x 0.6199999861419201, :y 5.1622000521337} {:x 0.6399999856948853, :y 5.264672973690672} {:x 0.6599999852478504, :y 5.367145895247646} {:x 0.6799999848008156, :y 5.469618816804617} {:x 0.6999999843537807, :y 5.57209173836159} {:x 0.7199999839067459, :y 5.674564659918563} {:x 0.7399999834597111, :y 5.777037581475534} {:x 0.7599999830126762, :y 5.879510503032508} {:x 0.7799999825656414, :y 5.98198342458948} {:x 0.7999999821186066, :y 6.084456346146453} {:x 0.8199999816715717, :y 6.186929267703425} {:x 0.8399999812245369, :y 6.289402189260397} {:x 0.8599999807775021, :y 6.39187511081737} {:x 0.8799999803304672, :y 6.494348032374342} {:x 0.8999999798834324, :y 6.596820953931315} {:x 0.9199999794363976, :y 6.699293875488287} {:x 0.9399999789893627, :y 6.801766797045259} {:x 0.9599999785423279, :y 6.904239718602232} {:x 0.979999978095293, :y 7.006712640159204} {:x 0.9999999776482582, :y 7.109185561716178})} {:name \"b40ab74d-9f22-4bcc-bc36-339bd4b35dd3\", :values ({:x 0.730967787376657, :y 6.056105468752801} {:x 0.24053641567148587, :y 2.751909034148673} {:x 0.6374174253501083, :y 6.227547521964622} {:x 0.5504370051176339, :y 5.134070409806414} {:x 0.5975452777972018, :y 5.480013655427266} {:x 0.3332183994766498, :y 2.8243858679995775} {:x 0.3851891847407185, :y 3.9123007922496487} {:x 0.984841540199809, :y 6.981830552430056} {:x 0.8791825178724801, :y 6.200829068672432} {:x 0.9412491794821144, :y 6.384551490847347} {:x 0.27495396603548483, :y 3.4010002837768423} {:x 0.12889715087377673, :y 2.9051567928338287} {:x 0.14660165764651822, :y 2.321024786888506} {:x 0.023238122483889456, :y 2.2465497094336255} {:x 0.5467397571984656, :y 4.5072049080712} {:x 0.9644868606768501, :y 7.524007994244719} {:x 0.10449068625097169, :y 2.6580187397899597} {:x 0.6251463634655593, :y 5.122204809652878} {:x 0.4107961954910617, :y 4.5064603271609736} {:x 0.7763122912749325, :y 6.309988580425002} {:x 0.990722785714783, :y 7.13978096929517} {:x 0.4872328470301428, :y 4.635000654651905} {:x 0.7462414053223305, :y 5.762679911419385} {:x 0.7331520701949938, :y 6.136490349798697} {:x 0.8172970714093244, :y 6.307037252564166} {:x 0.8388903500470183, :y 5.828511884655097} {:x 0.5266994346048661, :y 4.627615367098191} {:x 0.8993350116114935, :y 6.41799395998379} {:x 0.13393984058689223, :y 2.378570088375148} {:x 0.0830623982249149, :y 2.312326901874604} {:x 0.9785743401478403, :y 6.692921087783514} {:x 0.7223571191888487, :y 6.057443403477006} {:x 0.7150310138504744, :y 5.7805353863822} {:x 0.14322038530059678, :y 2.1304836763546695} {:x 0.4629578184224229, :y 4.119534982657109} {:x 0.004485602182885184, :y 2.267498212856079} {:x 0.07149831487989411, :y 2.837379201301554} {:x 0.34842022979166454, :y 4.118294246565511} {:x 0.3387696535357536, :y 3.3648700598920156} {:x 0.859356551354648, :y 6.6192989233531545} {:x 0.9715469888517128, :y 6.7000087834877124} {:x 0.8657458802140383, :y 6.856176798127287} {:x 0.6125811047098682, :y 5.360797112920585} {:x 0.17898798452881726, :y 3.406215406654946} {:x 0.21757041220968598, :y 1.9097536094804708} {:x 0.8544871670422907, :y 5.509901777540129} {:x 0.009673497300974332, :y 2.638796122613874} {:x 0.6922930069529333, :y 5.464535510300139} {:x 0.7713129661706796, :y 5.788070125816393} {:x 0.7126874281456893, :y 5.352333174692435})}), :marks ({:type \"line\", :from {:data \"23ddd9d3-ede6-4876-b3c5-3fe4d0ba5a55\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :stroke {:value \"red\"}, :strokeWidth {:value 2}, :strokeOpacity {:value 1}}}} {:type \"symbol\", :from {:data \"b40ab74d-9f22-4bcc-bc36-339bd4b35dd3\"}, :properties {:enter {:x {:scale \"x\", :field \"data.x\"}, :y {:scale \"y\", :field \"data.y\"}, :fill {:value \"steelblue\"}, :fillOpacity {:value 1}}, :update {:shape \"circle\", :size {:value 70}, :stroke {:value \"transparent\"}}, :hover {:size {:value 210}, :stroke {:value \"white\"}}}})}}"}
;; <=

;; @@

;; @@
